<!DOCTYPE html>
<html>
<head>
  <title>My A-Frame Scene</title>
  <script src="https://aframe.io/releases/0.3.0/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/AltspaceVR/AltspaceSDK/v2.4.2/dist/altspace.min.js"></script>
  <script src="https://unpkg.com/aframe-animation-component/dist/aframe-animation-component.min.js"></script>
</head>

<body>
  <a-scene altspace="fullspace: true" sync-system="author: phil; app: emoji">
	<a-assets>
		<img id="button" src="files/wur-button.png">
		<img id="skeleton" src="like.png">
		<a-mixin id="emoji1-mix"
			position="0 0.5 0" rotation="-10 180 0" scale="0.75 0.75 0.75" 
		 	geometry="primitive: plane; width: 1; height: 0.5" material="transparent: true; src: #skeleton"
			n-skeleton-parent="part: head;"
			sync sync-n-skeleton-parent></a-mixin>
		<a-mixin id="emoji2-mix"
			position="0 1 0" rotation="20 180 0" scale="0.25 0.25 0.25"
		 	geometry="primitive: plane; width: 1; height: 0.5" material="transparent: true; src: #skeleton"
			n-skeleton-parent="part: head;"
			sync sync-n-skeleton-parent></a-mixin>
		<a-mixin id="emoji3-mix"
			position="0 1.5 0" rotation="-30 180 0" scale="1 1 1"
		 	geometry="primitive: plane; width: 1; height: 0.5" material="transparent: true; src: #skeleton"
			n-skeleton-parent="part: head;"
			sync sync-n-skeleton-parent></a-mixin>
		<a-mixin id="emoji-button-mix"
			position="0.6 -0.15 -0.8" rotation="-30 0 0"
		 	geometry="primitive: plane; width: 0.4; height: 0.1" material="transparent: true; src: #button"
			n-cockpit-parent altspace-cursor-collider="enabled: true"></a-mixin>
	</a-assets>
	
	<!-- emoji button -->
	<a-entity id="emoji-button" mixin="emoji-button-mix"
		wire="on: click; emit: play; targets: #emoji1, #emoji2-parent, #emoji3, #emoji-sound;"
    		wire__over="on: mouseenter; emit: over;"
		wire__leave="on: mouseleave; emit: leave;"
		n-cockpit-parent altspace-cursor-collider="enabled: true">
		<a-animation attribute="scale" begin="over" dur="100" from="1 1 1" to="1.1 1.1 1.1" fill="forwards" direction="normal" repeat="0"></a-animation>
		<a-animation attribute="scale" begin="leave" dur="100" from="1.1 1.1 1.1" to="1 1 1" fill="forwards" direction="normal" repeat="0"></a-animation>
	</a-entity>
  
  	<a-entity id="emoji-sound" 
		geometry="primitive: plane; width: 0.1; height: 0.1" material="transparent: true;"
    		n-sound="src: files/notify.wav; on: animationend"
		n-skeleton-parent="part: head;" sync sync-n-sound>
		<a-animation attribute="scale" begin="play" dur="1" from="0.0001 0.0001 0.0001" to="1 1 1"></a-animation>
	</a-entity>
	
	<!-- emoji -->
	<a-entity id="emoji1" mixin="emoji1-mix" scale="0.0001 0.0001 0.0001" sync sync-transform
            animation="property: scale; dur: 200;
                           easing: easeInSine; to: 1 1 1"
            animation__hide="property: scale; dur: 200;
                           easing: easeInSine; delay: 500; to: 0.0001 0.0001 0.0001">
		
	</a-entity>
	<a-entity id="emoji2-parent" scale="0.0001 0.0001 0.0001" sync sync-transform>
		<a-animation attribute="scale" begin="play" dur="100" from="0.0001 0.0001 0.0001" to="1 1 1"></a-animation>
		<a-animation attribute="scale" begin="play" delay="500" dur="100" from="1 1 1" to="0.0001 0.0001 0.0001"></a-animation>
	  	<a-entity id="emoji1" instantiator="on: play; mixin: emoji2-mix" sync sync-transform>
		</a-entity>
	</a-entity>
	<a-entity id="emoji3" instantiator="on: play; mixin: emoji3-mix" scale="0.0001 0.0001 0.0001" sync sync-transform
            animation="startEvents: play; property: scale; dur: 200;
                           easing: easeInSine; delay: 500; to: 1 1 1"
            animation__hide="property: scale; dur: 200;
                           easing: easeInSine; delay: 1000; to: 0.0001 0.0001 0.0001">
	</a-entity>
  </a-scene>
</body>
</html>
